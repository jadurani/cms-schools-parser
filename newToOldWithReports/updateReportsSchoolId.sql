CREATE TEMPORARY TABLE OLD_SCHOOLS_WITH_REPORTS AS 
  SELECT 693 as school_id, 300418 as official_school_id
  union all
  SELECT 29165 as school_id, 120883 as official_school_id
  union all
  SELECT 29482 as school_id, 120885 as official_school_id
  union all
  SELECT 30002 as school_id, 120924 as official_school_id
  union all
  SELECT 32418 as school_id, 120900 as official_school_id
  union all
  SELECT 25627 as school_id, 115925 as official_school_id
  union all
  SELECT 6584 as school_id, 304412 as official_school_id
  union all
  SELECT 39416 as school_id, 129840 as official_school_id
  union all
  SELECT 39576 as school_id, 129842 as official_school_id
  union all
  SELECT 18721 as school_id, 108196 as official_school_id
  union all
  SELECT 31911 as school_id, 120979 as official_school_id
  union all
  SELECT 38960 as school_id, 129859 as official_school_id
  union all
  SELECT 38968 as school_id, 129860 as official_school_id
  union all
  SELECT 39180 as school_id, 129861 as official_school_id
  union all
  SELECT 39197 as school_id, 129862 as official_school_id
  union all
  SELECT 39373 as school_id, 129863 as official_school_id
  union all
  SELECT 39711 as school_id, 129867 as official_school_id
  union all
  SELECT 39770 as school_id, 207528 as official_school_id
  union all
  SELECT 39776 as school_id, 129869 as official_school_id
  union all
  SELECT 39821 as school_id, 129870 as official_school_id
  union all
  SELECT 40039 as school_id, 129871 as official_school_id
  union all
  SELECT 40054 as school_id, 129872 as official_school_id
  union all
  SELECT 40172 as school_id, 207550 as official_school_id
  union all
  SELECT 40171 as school_id, 129876 as official_school_id
  union all
  SELECT 764 as school_id, 300506 as official_school_id
  union all
  SELECT 38552 as school_id, 129893 as official_school_id
  union all
  SELECT 38559 as school_id, 129894 as official_school_id
  union all
  SELECT 38688 as school_id, 129897 as official_school_id
  union all
  SELECT 38691 as school_id, 129898 as official_school_id
  union all
  SELECT 6626 as school_id, 316554 as official_school_id
  union all
  SELECT 6664 as school_id, 600002 as official_school_id
  union all
  SELECT 38889 as school_id, 129900 as official_school_id
  union all
  SELECT 38892 as school_id, 129901 as official_school_id
  union all
  SELECT 38956 as school_id, 129902 as official_school_id
  union all
  SELECT 39029 as school_id, 129903 as official_school_id
  union all
  SELECT 39130 as school_id, 129906 as official_school_id
  union all
  SELECT 6747 as school_id, 304440 as official_school_id
  union all
  SELECT 39175 as school_id, 129907 as official_school_id
  union all
  SELECT 39188 as school_id, 129909 as official_school_id
  union all
  SELECT 39278 as school_id, 129913 as official_school_id
  union all
  SELECT 6883 as school_id, 304439 as official_school_id
  union all
  SELECT 39664 as school_id, 129922 as official_school_id
  union all
  SELECT 39927 as school_id, 129924 as official_school_id
  union all
  SELECT 39959 as school_id, 129925 as official_school_id
  union all
  SELECT 40018 as school_id, 207544 as official_school_id
  union all
  SELECT 40058 as school_id, 129927 as official_school_id
  union all
  SELECT 19694 as school_id, 170531 as official_school_id
  union all
  SELECT 38612 as school_id, 129931 as official_school_id
  union all
  SELECT 38643 as school_id, 129932 as official_school_id
  union all
  SELECT 38717 as school_id, 207516 as official_school_id
  union all
  SELECT 38768 as school_id, 129934 as official_school_id
  union all
  SELECT 39035 as school_id, 129936 as official_school_id
  union all
  SELECT 39154 as school_id, 129937 as official_school_id
  union all
  SELECT 39456 as school_id, 129940 as official_school_id
  union all
  SELECT 39503 as school_id, 129941 as official_school_id
  union all
  SELECT 39529 as school_id, 129943 as official_school_id
  union all
  SELECT 6861 as school_id, 304472 as official_school_id
  union all
  SELECT 6862 as school_id, 316531 as official_school_id
  union all
  SELECT 39801 as school_id, 129944 as official_school_id
  union all
  SELECT 39803 as school_id, 129945 as official_school_id
  union all
  SELECT 39836 as school_id, 129946 as official_school_id
  union all
  SELECT 39882 as school_id, 129948 as official_school_id
  union all
  SELECT 39894 as school_id, 129949 as official_school_id
  union all
  SELECT 39912 as school_id, 129950 as official_school_id
  union all
  SELECT 40186 as school_id, 129954 as official_school_id
  union all
  SELECT 29313 as school_id, 121026 as official_school_id
  union all
  SELECT 34634 as school_id, 120196 as official_school_id
  union all
  SELECT 1381 as school_id, 306715 as official_school_id
  union all
  SELECT 3034 as school_id, 301654 as official_school_id
  union all
  SELECT 48132 as school_id, 115821 as official_school_id
  union all
  SELECT 1309 as school_id, 300738 as official_school_id
  union all
  SELECT 2962 as school_id, 301734 as official_school_id
  union all
  SELECT 14203 as school_id, 106829 as official_school_id
  union all
  SELECT 17385 as school_id, 109398 as official_school_id
  union all
  SELECT 2024 as school_id, 301097 as official_school_id
  union all
  SELECT 15469 as school_id, 106848 as official_school_id
  union all
  SELECT 13599 as school_id, 160001 as official_school_id
  union all
  SELECT 14549 as school_id, 160019 as official_school_id
  union all
  SELECT 15044 as school_id, 160018 as official_school_id
  union all
  SELECT 15460 as school_id, 160016 as official_school_id
  union all
  SELECT 16412 as school_id, 160002 as official_school_id
  union all
  SELECT 17740 as school_id, 109416 as official_school_id
  union all
  SELECT 16805 as school_id, 109828 as official_school_id
  union all
  SELECT 16927 as school_id, 109840 as official_school_id
  union all
  SELECT 1946 as school_id, 301512 as official_school_id
  union all
  SELECT 1947 as school_id, 301513 as official_school_id
  union all
  SELECT 17049 as school_id, 109829 as official_school_id
  union all
  SELECT 17560 as school_id, 109816 as official_school_id
  union all
  SELECT 2142 as school_id, 301521 as official_school_id
  union all
  SELECT 17634 as school_id, 109818 as official_school_id
  union all
  SELECT 2168 as school_id, 308702 as official_school_id
  union all
  SELECT 2217 as school_id, 301520 as official_school_id
  union all
  SELECT 17898 as school_id, 109820 as official_school_id
  union all
  SELECT 2229 as school_id, 301523 as official_school_id
  union all
  SELECT 17981 as school_id, 109853 as official_school_id
  union all
  SELECT 18053 as school_id, 109821 as official_school_id
  union all
  SELECT 18263 as school_id, 109856 as official_school_id
  union all
  SELECT 18502 as school_id, 109823 as official_school_id
  union all
  SELECT 18789 as school_id, 109861 as official_school_id
  union all
  SELECT 19206 as school_id, 109827 as official_school_id
  union all
  SELECT 2732 as school_id, 301801 as official_school_id
  union all
  SELECT 21031 as school_id, 111581 as official_school_id
  union all
  SELECT 12471 as school_id, 103194 as official_school_id
  union all
  SELECT 12996 as school_id, 103220 as official_school_id
  union all
  SELECT 16673 as school_id, 107957 as official_school_id
  union all
  SELECT 2097 as school_id, 301194 as official_school_id
  union all
  SELECT 2203 as school_id, 342285 as official_school_id
  union all
  SELECT 2446 as school_id, 301214 as official_school_id
  union all
  SELECT 32841 as school_id, 126000 as official_school_id
  union all
  SELECT 18832 as school_id, 108481 as official_school_id
  union all
  SELECT 7136 as school_id, 304871 as official_school_id
  union all
  SELECT 41555 as school_id, 132977 as official_school_id
  union all
  SELECT 6646 as school_id, 316903 as official_school_id
  union all
  SELECT 19849 as school_id, 111002 as official_school_id
  union all
  SELECT 20763 as school_id, 111011 as official_school_id
  union all
  SELECT 12279 as school_id, 104281 as official_school_id
  union all
  SELECT 2167 as school_id, 304291 as official_school_id
  union all
  SELECT 4316 as school_id, 312352 as official_school_id
  union all
  SELECT 27551 as school_id, 118310 as official_school_id
  union all
  SELECT 27609 as school_id, 118311 as official_school_id
  union all
  SELECT 27633 as school_id, 118312 as official_school_id
  union all
  SELECT 28370 as school_id, 118315 as official_school_id
  union all
  SELECT 28709 as school_id, 118319 as official_school_id
  union all
  SELECT 32738 as school_id, 125062 as official_school_id
  union all
  SELECT 13976 as school_id, 158517 as official_school_id
  union all
  SELECT 15167 as school_id, 104850 as official_school_id
  union all
  SELECT 15922 as school_id, 104855 as official_school_id
  union all
  SELECT 16202 as school_id, 104858 as official_school_id
  union all
  SELECT 8593 as school_id, 302614 as official_school_id
  union all
  SELECT 47056 as school_id, 180508 as official_school_id
  union all
  SELECT 15436 as school_id, 106879 as official_school_id
  union all
  SELECT 25439 as school_id, 115507 as official_school_id
  union all
  SELECT 1906 as school_id, 301430 as official_school_id
  union all
  SELECT 25482 as school_id, 115864 as official_school_id
  union all
  SELECT 26307 as school_id, 115873 as official_school_id
  union all
  SELECT 6617 as school_id, 304421 as official_school_id
  union all
  SELECT 6745 as school_id, 316518 as official_school_id
  union all
  SELECT 39199 as school_id, 130015 as official_school_id
  union all
  SELECT 39225 as school_id, 130006 as official_school_id
  union all
  SELECT 39420 as school_id, 130008 as official_school_id
  union all
  SELECT 6922 as school_id, 316509 as official_school_id
  union all
  SELECT 39819 as school_id, 130018 as official_school_id
  union all
  SELECT 33251 as school_id, 125117 as official_school_id
  union all
  SELECT 5654 as school_id, 303799 as official_school_id
  union all
  SELECT 34293 as school_id, 125124 as official_school_id
  union all
  SELECT 31425 as school_id, 122983 as official_school_id
  union all
  SELECT 1847 as school_id, 301070 as official_school_id
  union all
  SELECT 17283 as school_id, 107404 as official_school_id
  union all
  SELECT 2094 as school_id, 301102 as official_school_id
  union all
  SELECT 17693 as school_id, 107409 as official_school_id
  union all
  SELECT 25616 as school_id, 114787 as official_school_id
  union all
  SELECT 38575 as school_id, 130036 as official_school_id
  union all
  SELECT 38752 as school_id, 130040 as official_school_id
  union all
  SELECT 38805 as school_id, 130037 as official_school_id
  union all
  SELECT 38806 as school_id, 130038 as official_school_id
  union all
  SELECT 38922 as school_id, 130041 as official_school_id
  union all
  SELECT 39176 as school_id, 130027 as official_school_id
  union all
  SELECT 39228 as school_id, 130028 as official_school_id
  union all
  SELECT 39256 as school_id, 130029 as official_school_id
  union all
  SELECT 6818 as school_id, 304461 as official_school_id
  union all
  SELECT 39411 as school_id, 130043 as official_school_id
  union all
  SELECT 39521 as school_id, 130030 as official_school_id
  union all
  SELECT 39728 as school_id, 207517 as official_school_id
  union all
  SELECT 39729 as school_id, 130031 as official_school_id
  union all
  SELECT 6913 as school_id, 304487 as official_school_id
  union all
  SELECT 39741 as school_id, 207571 as official_school_id
  union all
  SELECT 39779 as school_id, 130032 as official_school_id
  union all
  SELECT 40017 as school_id, 130045 as official_school_id
  union all
  SELECT 40197 as school_id, 130046 as official_school_id
  union all
  SELECT 40250 as school_id, 130042 as official_school_id
  union all
  SELECT 19619 as school_id, 111322 as official_school_id
  union all
  SELECT 2818 as school_id, 301765 as official_school_id
  union all
  SELECT 44562 as school_id, 135988 as official_school_id
  union all
  SELECT 39392 as school_id, 130246 as official_school_id
  union all
  SELECT 39396 as school_id, 130247 as official_school_id
  union all
  SELECT 39455 as school_id, 130225 as official_school_id
  union all
  SELECT 39676 as school_id, 130250 as official_school_id
  union all
  SELECT 39707 as school_id, 130227 as official_school_id
  union all
  SELECT 6910 as school_id, 304510 as official_school_id
  union all
  SELECT 39822 as school_id, 130232 as official_school_id
  union all
  SELECT 40141 as school_id, 130253 as official_school_id
  union all
  SELECT 30300 as school_id, 121624 as official_school_id
  union all
  SELECT 30354 as school_id, 191529 as official_school_id
  union all
  SELECT 32206 as school_id, 121627 as official_school_id
  union all
  SELECT 6587 as school_id, 316503 as official_school_id
  union all
  SELECT 38543 as school_id, 130047 as official_school_id
  union all
  SELECT 6934 as school_id, 304490 as official_school_id
  union all
  SELECT 6602 as school_id, 316538 as official_school_id
  union all
  SELECT 6620 as school_id, 304422 as official_school_id
  union all
  SELECT 38779 as school_id, 130074 as official_school_id
  union all
  SELECT 38780 as school_id, 207555 as official_school_id
  union all
  SELECT 39489 as school_id, 130079 as official_school_id
  union all
  SELECT 6875 as school_id, 304473 as official_school_id
  union all
  SELECT 40000 as school_id, 130081 as official_school_id
  union all
  SELECT 40089 as school_id, 130066 as official_school_id
  union all
  SELECT 5708 as school_id, 303812 as official_school_id
  union all
  SELECT 38799 as school_id, 130110 as official_school_id
  union all
  SELECT 6774 as school_id, 304456 as official_school_id
  union all
  SELECT 6844 as school_id, 304424 as official_school_id
  union all
  SELECT 6854 as school_id, 304469 as official_school_id
  union all
  SELECT 6973 as school_id, 304457 as official_school_id
  union all
  SELECT 39917 as school_id, 130091 as official_school_id
  union all
  SELECT 668 as school_id, 300262 as official_school_id
  union all
  SELECT 37351 as school_id, 128967 as official_school_id
  union all
  SELECT 37444 as school_id, 128981 as official_school_id
  union all
  SELECT 34944 as school_id, 126908 as official_school_id
  union all
  SELECT 20328 as school_id, 110169 as official_school_id
  union all
  SELECT 37213 as school_id, 129345 as official_school_id
  union all
  SELECT 23374 as school_id, 113658 as official_school_id
  union all
  SELECT 2772 as school_id, 301631 as official_school_id
  union all
  SELECT 1905 as school_id, 301083 as official_school_id
  union all
  SELECT 29210 as school_id, 121656 as official_school_id
  union all
  SELECT 29526 as school_id, 121657 as official_school_id
  union all
  SELECT 29832 as school_id, 121658 as official_school_id
  union all
  SELECT 29909 as school_id, 121659 as official_school_id
  union all
  SELECT 29962 as school_id, 121660 as official_school_id
  union all
  SELECT 31107 as school_id, 121662 as official_school_id
  union all
  SELECT 31181 as school_id, 121664 as official_school_id
  union all
  SELECT 32078 as school_id, 121670 as official_school_id
  union all
  SELECT 32090 as school_id, 121671 as official_school_id
  union all
  SELECT 6669 as school_id, 304431 as official_school_id
  union all
  SELECT 39669 as school_id, 130164 as official_school_id
  union all
  SELECT 39979 as school_id, 130141 as official_school_id
  union all
  SELECT 19131 as school_id, 165010 as official_school_id
  union all
  SELECT 34113 as school_id, 125255 as official_school_id
  union all
  SELECT 38555 as school_id, 130180 as official_school_id
  union all
  SELECT 38821 as school_id, 207525 as official_school_id
  union all
  SELECT 6693 as school_id, 304432 as official_school_id
  union all
  SELECT 38989 as school_id, 130182 as official_school_id
  union all
  SELECT 39080 as school_id, 130215 as official_school_id
  union all
  SELECT 39089 as school_id, 130183 as official_school_id
  union all
  SELECT 39113 as school_id, 130173 as official_school_id
  union all
  SELECT 39231 as school_id, 130184 as official_school_id
  union all
  SELECT 39426 as school_id, 130186 as official_school_id
  union all
  SELECT 39427 as school_id, 130172 as official_school_id
  union all
  SELECT 39620 as school_id, 130174 as official_school_id
  union all
  SELECT 39624 as school_id, 130175 as official_school_id
  union all
  SELECT 39671 as school_id, 130220 as official_school_id
  union all
  SELECT 6985 as school_id, 304501 as official_school_id
  union all
  SELECT 39940 as school_id, 130222 as official_school_id
  union all
  SELECT 39946 as school_id, 130179 as official_school_id
  union all
  SELECT 40040 as school_id, 130204 as official_school_id
  union all
  SELECT 7057 as school_id, 316549 as official_school_id
  union all
  SELECT 7071 as school_id, 304516 as official_school_id
  union all
  SELECT 36700 as school_id, 200544 as official_school_id
  union all
  SELECT 37481 as school_id, 128487 as official_school_id
  union all
  SELECT 19377 as school_id, 111052 as official_school_id
  union all
  SELECT 2146 as school_id, 301107 as official_school_id
  union all
  SELECT 24827 as school_id, 115905 as official_school_id
  union all
  SELECT 24909 as school_id, 115892 as official_school_id
  union all
  SELECT 25548 as school_id, 115909 as official_school_id
  union all
  SELECT 4050 as school_id, 302434 as official_school_id
  union all
  SELECT 26014 as school_id, 115903 as official_school_id
  union all
  SELECT 26064 as school_id, 115914 as official_school_id
  union all
  SELECT 26229 as school_id, 115915 as official_school_id
  union all
  SELECT 4100 as school_id, 302436 as official_school_id
  union all
  SELECT 13958 as school_id, 107119 as official_school_id
  union all
  SELECT 1818 as school_id, 300775 as official_school_id
  union all
  SELECT 38769 as school_id, 130287 as official_school_id
  union all
  SELECT 39234 as school_id, 130266 as official_school_id
  union all
  SELECT 6878 as school_id, 316536 as official_school_id
  union all
  SELECT 6889 as school_id, 304479 as official_school_id
  union all
  SELECT 39811 as school_id, 130275 as official_school_id
  union all
  SELECT 6943 as school_id, 304493 as official_school_id
  union all
  SELECT 6961 as school_id, 304499 as official_school_id
  union all
  SELECT 40145 as school_id, 207509 as official_school_id
  union all
  SELECT 38733 as school_id, 130318 as official_school_id
  union all
  SELECT 6685 as school_id, 316541 as official_school_id
  union all
  SELECT 7022 as school_id, 304509 as official_school_id
  union all
  SELECT 5242 as school_id, 303640 as official_school_id
  union all
  SELECT 40007 as school_id, 130747 as official_school_id
  union all
  SELECT 19934 as school_id, 111513 as official_school_id
  union all
  SELECT 2811 as school_id, 301784 as official_school_id
  union all
  SELECT 45994 as school_id, 136564 as official_school_id
  union all
  SELECT 1949 as school_id, 301440 as official_school_id
  union all
  SELECT 2407 as school_id, 301442 as official_school_id
  union all
  SELECT 18787 as school_id, 109468 as official_school_id
  union all
  SELECT 20722 as school_id, 110241 as official_school_id
  union all
  SELECT 16401 as school_id, 106649 as official_school_id
  union all
  SELECT 26534 as school_id, 112263 as official_school_id
  union all
  SELECT 48270 as school_id, 109495 as official_school_id
  union all
  SELECT 2120 as school_id, 301103 as official_school_id
  union all
  SELECT 10775 as school_id, 100634 as official_school_id
  union all
  SELECT 5756 as school_id, 303818 as official_school_id
  union all
  SELECT 19191 as school_id, 107735 as official_school_id
  union all
  SELECT 2551 as school_id, 307727 as official_school_id
  union all
  SELECT 17316 as school_id, 423570 as official_school_id
  union all
  SELECT 17552 as school_id, 107741 as official_school_id
  union all
  SELECT 18457 as school_id, 163506 as official_school_id
  union all
  SELECT 19171 as school_id, 107744 as official_school_id
  union all
  SELECT 6907 as school_id, 130880 as official_school_id
  union all
  SELECT 1916 as school_id, 301087 as official_school_id
  union all
  SELECT 16692 as school_id, 109537 as official_school_id
  union all
  SELECT 18926 as school_id, 109533 as official_school_id
  union all
  SELECT 1825 as school_id, 308103 as official_school_id
  union all
  SELECT 21796 as school_id, 113140 as official_school_id
  union all
  SELECT 33687 as school_id, 125491 as official_school_id
  union all
  SELECT 38634 as school_id, 130390 as official_school_id
  union all
  SELECT 39285 as school_id, 130393 as official_school_id
  union all
  SELECT 39338 as school_id, 130408 as official_school_id
  union all
  SELECT 39688 as school_id, 130396 as official_school_id
  union all
  SELECT 7006 as school_id, 304504 as official_school_id
  union all
  SELECT 7058 as school_id, 304515 as official_school_id
  union all
  SELECT 1924 as school_id, 301088 as official_school_id
  union all
  SELECT 2139 as school_id, 307710 as official_school_id
  union all
  SELECT 4933 as school_id, 313322 as official_school_id
  union all
  SELECT 43348 as school_id, 133524 as official_school_id
;
SELECT * FROM OLD_SCHOOLS_WITH_REPORTS;

CREATE TEMPORARY TABLE NEW_ID_SCHOOLS_WITH_REPORTS AS
  SELECT
    ks.school_id as new_school_id,
    oswr.school_id as old_school_id
  FROM ki_schools ks, OLD_SCHOOLS_WITH_REPORTS oswr
  WHERE ks.official_school_id=oswr.official_school_id
;

SELECT * FROM NEW_ID_SCHOOLS_WITH_REPORTS;

CREATE TEMPORARY TABLE REPORTS_UNCHANGED AS
  SELECT
    kr.id as report_id,
    kr.school_id as report_school_id,
    niswr.new_school_id as new_school_id,
    niswr.old_school_id as old_school_id
  FROM
    ki_reports kr,
    NEW_ID_SCHOOLS_WITH_REPORTS niswr
  WHERE
    kr.school_id=niswr.old_school_id
;

SELECT * FROM REPORTS_UNCHANGED;

UPDATE ki_reports kr, NEW_ID_SCHOOLS_WITH_REPORTS niswr
SET kr.school_id=niswr.new_school_id
WHERE kr.school_id=niswr.old_school_id;

CREATE TEMPORARY TABLE REPORTS_CHANGED AS
  SELECT
    kr.id as report_id,
    kr.school_id as report_school_id,
    niswr.new_school_id as new_school_id,
    niswr.old_school_id as old_school_id
  FROM
    ki_reports kr,
    NEW_ID_SCHOOLS_WITH_REPORTS niswr
  WHERE
    kr.school_id=niswr.new_school_id
;

SELECT * FROM REPORTS_CHANGED;

